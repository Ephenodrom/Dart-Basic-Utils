import 'dart:convert';

import 'package:basic_utils/src/X509Utils.dart';
import 'package:basic_utils/src/model/ocsp/OCSPCertStatus.dart';
import 'package:basic_utils/src/model/ocsp/OCSPCertStatusValues.dart';
import 'package:basic_utils/src/model/ocsp/OCSPResponseStatus.dart';
import 'package:pointycastle/impl.dart';
import 'package:pointycastle/pointycastle.dart';
import 'package:test/test.dart';

// ignore: avoid_relative_lib_imports
import '../lib/src/CryptoUtils.dart';

void main() {
  var csr = '''-----BEGIN CERTIFICATE REQUEST-----
MIICvzCCAacCAQAwejELMAkGA1UEBhMCREUxEjAQBgNVBAgMCUZha2VzdGF0ZTER
MA8GA1UEBwwIRmFrZXRvd24xEzARBgNVBAoMCkVwaGVub2Ryb20xFTATBgNVBAsM
DERldmVsb3BlbWVudDEYMBYGA1UEAwwPYmFzaWMtdXRpbHMuZGV2MIIBIjANBgkq
hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0QX4e8oAKpD91eKKLL/EdrH02N/Ulg35
bdCJSozHubnoDG7ZXiELTFuPDANNmG4HmxVUpHv1uxmVrbzECnqBBEzjLW5NaW2T
9U74ACo23HmDFQJqiTF/aVFcfEzKwHXtZeVVCrXU5MEvnFjDrEOrgZIFd46AElSt
/IU6d6zKRlFx6pYgB64mPW3L50sNrg6ONkCfXt7HT5u2ftzo/iP5qi41BtzJUk2d
S9DskbweQ8mv4KRstjawioQf2Qjew/lgaVSf5V5YEFWnvHLCh15/LwbN5Z6EN0Ks
7i0gkefKfg+7ydd7eU4jHKhmE15Kbu59uWgS9cswJ4jmXPPqukusZQIDAQABoAAw
DQYJKoZIhvcNAQELBQADggEBAMLfJml1DbYOnUA7Nwlutk6suMmS0FDkQLXFiJQk
Ks5Fy6rfNtV1Z8KL/xGqAzyAcuAXL+0cQMZRsNTd9sT5ZriSzoikwaeIKOoRqhFq
bKXqlhYSbgmVUiYKm9HI3w+rzyZ+JXhiRXZ1ZGZXwEjBSu+Ne+SPE12mYlK+4zBx
gPTDMrvb73QiqHqiGc/l5UjwFyrOUsq5GtiMc6QU+rAQjj6Ix6KqOzJIxyVdRzOC
c47tT30d2tJEJbDHGutbqLQFRr7xx7uHP/LGggTFN8Zs2u+cQxPRFsIhQdpDY1MF
tHAaI8r/tlZQWf3fu4FVZMbxrYTMA5cwz/TxweMKWTroN5c=
-----END CERTIFICATE REQUEST-----''';

  var eccCsr = '''-----BEGIN CERTIFICATE REQUEST-----
MIIBLTCB1QIBADBzMQswCQYDVQQGEwJERTESMBAGA1UECAwJRmFrZVN0YXRlMREw
DwYDVQQHDAhGYWtlQ2l0eTEQMA4GA1UECgwHRmFrZU9yZzERMA8GA1UECwwIRmFr
ZVVuaXQxGDAWBgNVBAMMD2Jhc2ljLXV0aWxzLmRldjBZMBMGByqGSM49AgEGCCqG
SM49AwEHA0IABNPipBb/4mYzBOPg790huspXlAgsh34LkQR9EsUMyxCYOEhSlD5E
bPldDpxW+OPqe9E5+H79Yt9WHcYurdqluw+gADAKBggqhkjOPQQDAgNHADBEAiAX
fPGC9L6I+0SLjaz6saiNV5iEzCd7FFLUxwS/NldS3gIgbGt2BH8BvSsPQ8YMN+ad
/LFkdPu/ZgVpCkV/950NU3k=
-----END CERTIFICATE REQUEST-----''';

  var unformattedKey =
      'MIICvzCCAacCAQAwejELMAkGA1UEBhMCREUxEjAQBgNVBAgMCUZha2VzdGF0ZTERMA8GA1UEBwwIRmFrZXRvd24xEzARBgNVBAoMCkVwaGVub2Ryb20xFTATBgNVBAsMDERldmVsb3BlbWVudDEYMBYGA1UEAwwPYmFzaWMtdXRpbHMuZGV2MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0QX4e8oAKpD91eKKLL/EdrH02N/Ulg35bdCJSozHubnoDG7ZXiELTFuPDANNmG4HmxVUpHv1uxmVrbzECnqBBEzjLW5NaW2T9U74ACo23HmDFQJqiTF/aVFcfEzKwHXtZeVVCrXU5MEvnFjDrEOrgZIFd46AElSt/IU6d6zKRlFx6pYgB64mPW3L50sNrg6ONkCfXt7HT5u2ftzo/iP5qi41BtzJUk2dS9DskbweQ8mv4KRstjawioQf2Qjew/lgaVSf5V5YEFWnvHLCh15/LwbN5Z6EN0Ks7i0gkefKfg+7ydd7eU4jHKhmE15Kbu59uWgS9cswJ4jmXPPqukusZQIDAQABoAAwDQYJKoZIhvcNAQELBQADggEBAMLfJml1DbYOnUA7Nwlutk6suMmS0FDkQLXFiJQkKs5Fy6rfNtV1Z8KL/xGqAzyAcuAXL+0cQMZRsNTd9sT5ZriSzoikwaeIKOoRqhFqbKXqlhYSbgmVUiYKm9HI3w+rzyZ+JXhiRXZ1ZGZXwEjBSu+Ne+SPE12mYlK+4zBxgPTDMrvb73QiqHqiGc/l5UjwFyrOUsq5GtiMc6QU+rAQjj6Ix6KqOzJIxyVdRzOCc47tT30d2tJEJbDHGutbqLQFRr7xx7uHP/LGggTFN8Zs2u+cQxPRFsIhQdpDY1MFtHAaI8r/tlZQWf3fu4FVZMbxrYTMA5cwz/TxweMKWTroN5c=';

  var x509Pem = '''-----BEGIN CERTIFICATE-----
MIIFDTCCA/WgAwIBAgIQBxYr+XmB67PWzCkR7C39iDANBgkqhkiG9w0BAQsFADBA
MQswCQYDVQQGEwJVUzERMA8GA1UEChMIT0VNIFRlc3QxHjAcBgNVBAMTFUZ1bGwg
T0VNIFRlc3QgUlNBIFN1YjAeFw0xOTAzMTEwMDAwMDBaFw0yMDAzMTAxMjAwMDBa
MHsxCzAJBgNVBAYTAkRFMQ8wDQYDVQQIEwZCYXllcm4xEzARBgNVBAcTClJlZ2Vu
c2J1cmcxFzAVBgNVBAoTDkludGVyTmV0WCBHbWJIMRQwEgYDVQQLEwtFbnR3aWNr
bHVuZzEXMBUGA1UEAxMOanVua2RyYWdvbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUA
A4IBDwAwggEKAoIBAQDDGv7+2oQyRWvFAt7UxtAQJB6zajegzrlvLLZ4+PhhJt6w
aSDW6IPV7H4uIvgL3cHP68AkATl+2fW0CEPy2i3vO27VDtxMp2oTk/IdPtVbNtZB
sjeFiNVzr7ZaD6z0u41WLEQbR34CmlWbggza3SS0tvPXD02YJpDz/Qm43hz0m+SJ
0IaesAM7b1tTbmlCxg3rm+CViU9wTsI9eUvOCZIjKS3E3MVcRJZTCCaZMp8JMKct
Ae4B90RunGbpvsYvWo4W4UQMFCVYcZp47FFeWcUnqx03nrSdP3LEEPcePVsRxPeB
ptsZzby9Wf7Sc2UNzTZSGjzxlpItgXdsjL4HiR/VAgMBAAGjggHGMIIBwjAfBgNV
HSMEGDAWgBS8odGV3/ZO7g4f11MzIg9X66vlUjAdBgNVHQ4EFgQUTriCU/8x5yQN
BoQPPYQcUVL7FUIwQQYDVR0RBDowOIIOanVua2RyYWdvbnMuZGWCEnd3dy5qdW5r
ZHJhZ29ucy5kZYISYXBpLmp1bmtkcmFnb25zLmRlMA4GA1UdDwEB/wQEAwIFoDAd
BgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwPgYDVR0fBDcwNTAzoDGgL4Yt
aHR0cDovL2NkcC5yYXBpZHNzbC5jb20vRnVsbE9FTVRlc3RSU0FTdWIuY3JsMEwG
A1UdIARFMEMwNwYJYIZIAYb9bAEBMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3
LmRpZ2ljZXJ0LmNvbS9DUFMwCAYGZ4EMAQICMHUGCCsGAQUFBwEBBGkwZzAmBggr
BgEFBQcwAYYaaHR0cDovL3N0YXR1cy5yYXBpZHNzbC5jb20wPQYIKwYBBQUHMAKG
MWh0dHA6Ly9jYWNlcnRzLnJhcGlkc3NsLmNvbS9GdWxsT0VNVGVzdFJTQVN1Yi5j
cnQwCQYDVR0TBAIwADANBgkqhkiG9w0BAQsFAAOCAQEAwCJAiSMJSYCIrJZdcLmY
zgH/Hd6VUDQzuo/s8Q+UoqpwyPwGnmNpovvzfjtz2+bF0dCQwUWerm61kYF/3IU6
ucrdTW4uS+T11tipJgDUBU8jEHvASe+QNIP7BiNoXCs10SfI8FQajL0HxnHY0vKC
AAQiFStLngxNYduyz4C3ZUjeNjt/8NhCUhd2GZGA6gveHKvck47ZWFbblecH8Odw
nhzR+ztf+lSGoyQW+egNlPog/OLjr//kKx7kjuuvXa5Os8oPLENu6LAjTZJqGvJP
ga7IcCj2gCeuTdS4Ibhx3hiew7cfuGa9XbVd5JJmV8kIoFlzLrZpKB4eVDKqaNWg
/g==
-----END CERTIFICATE-----''';

  var x509PemV1 = '''-----BEGIN CERTIFICATE-----
MIIEGjCCAwICEQCbfgZJoz5iudXukEhxKe9XMA0GCSqGSIb3DQEBBQUAMIHKMQsw
CQYDVQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZl
cmlTaWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWdu
LCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlT
aWduIENsYXNzIDMgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3Jp
dHkgLSBHMzAeFw05OTEwMDEwMDAwMDBaFw0zNjA3MTYyMzU5NTlaMIHKMQswCQYD
VQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlT
aWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWduLCBJ
bmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlTaWdu
IENsYXNzIDMgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkg
LSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMu6nFL8eB8aHm8b
N3O9+MlrlBIwT/A2R/XQkQr1F8ilYcEWQE37imGQ5XYgwREGfassbqb1EUGO+i2t
KmFZpGcmTNDovFJbcCAEWNF6yaRpvIMXZK0Fi7zQWM6NjPXr8EJJC52XJ2cybuGu
kxUccLwgTS8Y3pKI6GyFVxEa6X7jJhFUokWWVYPKMIno3Nij7SqAP395ZVc+FSBm
CC+Vk7+qRy+oRpfwEuL+wgorUeZ25rdGt+INpsyow0xZVYnm6FNcHOqd8GIWC6fJ
Xwzw3sJ2zq/3avL6QaaiMxTJ5Xpj055iN9WFZZ4O5lMkdBteHRJTW8cs54NJOxWu
imi5V5cCAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAERSWwauSCPc/L8my/uRan2Te
2yFPhpk0djZX3dAVL8WtfxUfN2JzPtTnX84XA9s1+ivbrmAJXx5fj267Cz3qWhMe
DGBvtcC1IyIuBwvLqXTLR7sdwdela8wv0kL9Sd2nic9TutoAWii/gt/4uhMdUIaC
/Y4wjylGsB49Ndo4YhYYSq3mtlFs3q9i6wHQHiT+eo8SGhJouPtmmRQURVyu565p
F4ErWjfJXir0xuKhXFSbplQAz/DxwceYMBo7Nhbbo27q/a2ywtrvAkcTisDxszGt
TxzhT5yvDwyd93gN2PQ1VoDat20Xj50egWTh/sVFuq1ruQp6Tk9LhO5L8X3dEQ==
-----END CERTIFICATE-----''';

  var x509PemWithGeneralizedTime = '''-----BEGIN CERTIFICATE-----
MIIEAzCCAuugAwIBAgIQVID5oHPtPwBMyonY43HmSjANBgkqhkiG9w0BAQUFADB1
MQswCQYDVQQGEwJFRTEiMCAGA1UECgwZQVMgU2VydGlmaXRzZWVyaW1pc2tlc2t1
czEoMCYGA1UEAwwfRUUgQ2VydGlmaWNhdGlvbiBDZW50cmUgUm9vdCBDQTEYMBYG
CSqGSIb3DQEJARYJcGtpQHNrLmVlMCIYDzIwMTAxMDMwMTAxMDMwWhgPMjAzMDEy
MTcyMzU5NTlaMHUxCzAJBgNVBAYTAkVFMSIwIAYDVQQKDBlBUyBTZXJ0aWZpdHNl
ZXJpbWlza2Vza3VzMSgwJgYDVQQDDB9FRSBDZXJ0aWZpY2F0aW9uIENlbnRyZSBS
b290IENBMRgwFgYJKoZIhvcNAQkBFglwa2lAc2suZWUwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQDIIMDs4MVLqwd4lfNE7vsLDP90jmG7sWLqI9iroWUy
euuOF0+W2Ap7kaJjbMeMTC55v6kF/GlclY1i+blw7cNRfdCT5mzrMEvhvH2/UpvO
bntl8jixwKIy72KyaOBhU8E2lf/slLo2rpwcpzIP5Xy0xm90/XsY6KxX7QYgSzIw
WFv9zajmofxwvI6Sc9uXp3whrj3B9UiHbCe9nyV0gVWw93X2PaRka9ZP585ArQ/d
MtO8ihJTmMmJ+xAdTX7Nfh9WDSFwhfYggx/2uh8Ej+p3iDXE/+pOoYtNP2MbRMNE
1CV2yreN1x5KZmTNXMWcg+HCCIia7E6j8T4cLNlsHaFLAgMBAAGjgYowgYcwDwYD
VR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAQYwHQYDVR0OBBYEFBLyWj7qVhy/
zQas8fElyalL1BSZMEUGA1UdJQQ+MDwGCCsGAQUFBwMCBggrBgEFBQcDAQYIKwYB
BQUHAwMGCCsGAQUFBwMEBggrBgEFBQcDCAYIKwYBBQUHAwkwDQYJKoZIhvcNAQEF
BQADggEBAHv25MANqhlHt01Xo/6tu7Fq1Q+e2+RjxY6hUFaTlrg4wCQiZrxTFGGV
v9DHKpY5P30osxBAIWrEr7BSdxjhlthWXePdNl4dp1BUoMUq5KqMlIpPnTX/dqQG
E5Gion0ARD9V04I8GtVbvFZMIi5GQ4okQC3zErg7cBqklrkar4dBGmoYDQZPxz5u
uSlNDUmJEYcyW+ZLBMjkXOZ0c5RdFpgTlf7727FE5TpwrDdr5rMzcijJs1eg9gIW
iAYLtqZLICjU3j2LrTcFU3T+bsy8QxdxXvnFzBqpYe73dgzzcvRyrc9yAjYHR8/v
GVCJYMzpJJUPwssd8m92kMfMdcGWxZ0=
-----END CERTIFICATE-----''';

  var x509PemWithTeletextString = '''-----BEGIN CERTIFICATE-----
MIIEKjCCAxKgAwIBAgIEOGPe+DANBgkqhkiG9w0BAQUFADCBtDEUMBIGA1UEChML
RW50cnVzdC5uZXQxQDA+BgNVBAsUN3d3dy5lbnRydXN0Lm5ldC9DUFNfMjA0OCBp
bmNvcnAuIGJ5IHJlZi4gKGxpbWl0cyBsaWFiLikxJTAjBgNVBAsTHChjKSAxOTk5
IEVudHJ1c3QubmV0IExpbWl0ZWQxMzAxBgNVBAMTKkVudHJ1c3QubmV0IENlcnRp
ZmljYXRpb24gQXV0aG9yaXR5ICgyMDQ4KTAeFw05OTEyMjQxNzUwNTFaFw0yOTA3
MjQxNDE1MTJaMIG0MRQwEgYDVQQKEwtFbnRydXN0Lm5ldDFAMD4GA1UECxQ3d3d3
LmVudHJ1c3QubmV0L0NQU18yMDQ4IGluY29ycC4gYnkgcmVmLiAobGltaXRzIGxp
YWIuKTElMCMGA1UECxMcKGMpIDE5OTkgRW50cnVzdC5uZXQgTGltaXRlZDEzMDEG
A1UEAxMqRW50cnVzdC5uZXQgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkgKDIwNDgp
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArU1LqRKGsuqjIAcVFmQq
K0vRvwtKTY7tgHalZ7d4QMBzQshowNtTK91euHaYNZOLGp18EzoOH1u3Hs/lJBQe
sYGpjX24zGtLA/ECDNyrpUAkAH90lKGdCCmziAv1h3edVc3kw37XamSrhRSGlVuX
MlBvPci6Zgzj/L24ScF2iUkZ/cCovYmjZy/Gn7xxGWC4LeksyZB2ZnuU4q941mVT
XTzWnLLPKQP5L6RQstRIzgUyVYr9smRMDuSYB3Xbf9+5CFVghTAp+XtIpGmG4zU/
HoZdenoVve8AjhUiVBcAkCaTvA5JaJG/+EfTnZVCwQ5N328mz8MYIWJmQ3DW1cAH
4QIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAQYwDwYDVR0TAQH/BAUwAwEB/zAdBgNV
HQ4EFgQUVeSB0RGAvtiJuQijMfmhJAkWuXAwDQYJKoZIhvcNAQEFBQADggEBADub
j1abMOdTmXx6eadNl9cZlZD7Bh/KM3xGY4+WZiT6QBshJ8rmcnPyT/4xmf3IDExo
U8aAghOY+rat2l098c5u9hURlIIM7j+VrxGrD9cv3h8Dj1csHsm7mhpElesYT6Yf
zX1XEC+bBAlahLVu2B064dae0Wx5XnkcFMXj0EyTO2U87d89vqbllRrDtRnDvV5b
u/8j72gZyxKTJ1wDLW8w0B62GqzeWvfRqqgnpv55gcR5mTNXuhKwqeBCbJPKVt7+
bYQLCIt+jerXmCHG8+c8eS9enNFMFY3h7CI3zJpDC5fcgJCNs2ebb0gIFVbPv/Er
fF6adulZkMV8gzURZVE=
-----END CERTIFICATE-----''';

  var X509WithSans = '''-----BEGIN CERTIFICATE-----
MIIDsTCCApmgAwIBAgIUDmyV5Jod3FGoVStvzghkIs1xZTcwDQYJKoZIhvcNAQEL
BQAwajELMAkGA1UEBhMCREUxCzAJBgNVBAgMAkJZMQ0wCwYDVQQHDARDaXR5MRAw
DgYDVQQKDAdDb21wYW55MRUwEwYDVQQLDAxEZXZlbG9wZW1lbnQxFjAUBgNVBAMM
DWVwaGVub2Ryb20uZGUwHhcNMTkxMTI2MTA1MjMzWhcNMjExMTI1MTA1MjMzWjBq
MQswCQYDVQQGEwJERTELMAkGA1UECAwCQlkxDTALBgNVBAcMBENpdHkxEDAOBgNV
BAoMB0NvbXBhbnkxFTATBgNVBAsMDERldmVsb3BlbWVudDEWMBQGA1UEAwwNZXBo
ZW5vZHJvbS5kZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALkzNq/p
4YblpAyXOCZAsTgZau2NvmyJ/B4H4SgGC+A4sJCBRuhsiZTSxUHiF4Y1WkXPNIRJ
wxMU0BLCbpLP3QYJpXwQhRtVJB2I4BWybAS2zzV1s6x6XLJsuJUQxZXN4rBdSocN
+D9v4qsfaIIkN7CXnEmTFlzUh33YqL/lmCDZcIQe4HIGa7ElfgzMLEcDh60AsUrr
JSgIDGuAKfxRaZLYY1wpRm3sxkwSSGKYFZK/H34GDC3/PGqyLPxFHIeLRFwIlJH+
r/puvcKlot8dh3SCDgNGuzszbfN351Kdp01ZHVzoMLVMsC93hux/kfsBFPR7NSO2
tG9ClLZ23CdqcIcCAwEAAaNPME0wCwYDVR0PBAQDAgQwMBMGA1UdJQQMMAoGCCsG
AQUFBwMBMCkGA1UdEQQiMCCCEWFwaS5lcGhlbm9kcm9tLmRlggsxOTIuMTY4LjAu
MTANBgkqhkiG9w0BAQsFAAOCAQEALAS85yXzCcdpN2uPQIx9edN4/0sglP+hVEXA
XtWgjq8uYpPmSUdjPYMDQzg+A+zgLQc8FB2YK8bk/yuaDRZaRt8xhjaXQsRhrKf8
pAvj+Cwzy5Sn+L21a1xd+IJHVSh+B0xF8H7D9G2+KwG4GbEkwprDdCh/Ci39/5qg
eRnR3fZYB8vnirc4pJr8tOoZ3aKsdyFyBhozZNQETihW1vrzegs5/rQlLmSUwb3C
TQiUAMlBpzuKM6oCy833Ed+uCtCwGAj0unysv9o7pYv4dKW4REyBGQ0lJltpN3Cg
MrWLubLgMfDzQmOC3oOeNVBDUsQBdFwJwqEEO658U+/OsQYVlw==
-----END CERTIFICATE-----''';

  var X509WithIpSans = '''-----BEGIN CERTIFICATE-----
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
h9vE3e4Cq0OS3DA=
-----END CERTIFICATE-----''';

  var certWithoutCN = '''-----BEGIN CERTIFICATE-----
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
8UhhGUUcPT6NuTN1LY7k+wvsdcRayEU=
-----END CERTIFICATE-----''';

  var selfSigned = '''-----BEGIN CERTIFICATE-----
MIID7TCCAtWgAwIBAgIBCjANBgkqhkiG9w0BAQsFADCBujELMAkGA1UEBhMCUlUx
FjAUBgNVBAgMDU1vc2NvdyBPYmxhc3QxEDAOBgNVBAcMB0tvcm9sZXYxJTAjBgNV
BAoMHEhpa3Zpc2lvbiBEaWdpdGFsIFRlY2hub2xvZ3kxFjAUBgNVBAMMDTk0LjE5
OC4xMzEuNTUxGTAXBgNVBAsMEEhpa3Zpc2lvbiBSdXNzaWExJzAlBgkqhkiG9w0B
CQEWGHN1cHBvcnQucnVAaGlrdmlzaW9uLmNvbTAeFw0yMDExMTUwOTAwMThaFw0z
MDExMTUwOTAwMThaMIG6MQswCQYDVQQGEwJSVTEWMBQGA1UECAwNTW9zY293IE9i
bGFzdDEQMA4GA1UEBwwHS29yb2xldjElMCMGA1UECgwcSGlrdmlzaW9uIERpZ2l0
YWwgVGVjaG5vbG9neTEWMBQGA1UEAwwNOTQuMTk4LjEzMS41NTEZMBcGA1UECwwQ
SGlrdmlzaW9uIFJ1c3NpYTEnMCUGCSqGSIb3DQEJARYYc3VwcG9ydC5ydUBoaWt2
aXNpb24uY29tMIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEA2OHq1U7I
UvX+DQloekW1f+moc9BX6ogOG6lS1EfZ4jBQCZ5zDhLxhCAcaICa30jHlHtcWNMw
9AkFQi19CmngxU+c4nw8elLn8QMA4gHBDOdPlLMH5jx7r0L9qZLxZ5zN/U2QpJbz
8tFRBI4U/L8Kiypy1VHg36MSOGhrPtjMu4s2Cl9Pmz+HG/9Gun4nyH6rLsh9YnMk
gkMYNNDsoXAQ2XlM6D8Obw0GWibYOl4aNU4Z5DAPeyokPR1D1RaoH9lu3nH2JaoZ
5dOfJwrUchSUEwD/a0VGVMbVnK1HN99ZEfQVhzFvhyserYXxryhvk8xhVGs1BLZF
gulrh83aWFTltQIBAzANBgkqhkiG9w0BAQsFAAOCAQEADE9QYRIrqDZzqZwElDiI
yQdqGtouhz3Hxp/2oR5e0S/Zv+SyJCN5TWaFrnSKeYUNgoWpd4HwYaZ91+OKr4pg
pC3GyaocUthbg8Z1CSjJvLlBg4yyJ3ydANmx7Wf5luokItsTHdLX3j4JLlV97I4u
ue9WtHfK9LZqplDg2foDreC2ZXLXi7CaPCaxMyizIXxqekkPmyXK1AJDXxLXs/Eq
dj4aM+vWzHutpNb6bhzzgQALeAYOpI7akiJhjh7oHrhqiP7f1o+MVtJHNiRFy8em
HqE2zJz1wkcCwanxmQ4Sc+BQxIUXwsbq2tuknKfvOfaTSD226yn65C73cLKv97tr
yA==
-----END CERTIFICATE-----''';

  var bigCert = '''-----BEGIN CERTIFICATE-----
MIIG/jCCBeagAwIBAgIRAOwUGsZYjUIAP+uYrlVr+vUwDQYJKoZIhvcNAQELBQAw
gZYxCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO
BgNVBAcTB1NhbGZvcmQxGjAYBgNVBAoTEUNPTU9ETyBDQSBMaW1pdGVkMTwwOgYD
VQQDEzNDT01PRE8gUlNBIE9yZ2FuaXphdGlvbiBWYWxpZGF0aW9uIFNlY3VyZSBT
ZXJ2ZXIgQ0EwHhcNMTgwMjA2MDAwMDAwWhcNMjEwMjA1MjM1OTU5WjCB/jELMAkG
A1UEBhMCVVMxDjAMBgNVBBETBTgwMjAzMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMG
RGVudmVyMRYwFAYDVQQJEw0xODAwIEdyYW50IFN0MR8wHQYDVQQKExZVbml2ZXJz
aXR5IG9mIENvbG9yYWRvMScwJQYDVQQLEx5Vbml2ZXJzaXR5IEluZm9ybWF0aW9u
IFN5c3RlbXMxKTAnBgNVBAsTIEhvc3RlZCBieSBVbml2ZXJzaXR5IG9mIENvbG9y
YWRvMR8wHQYDVQQLExZVbmlmaWVkIENvbW11bmljYXRpb25zMRMwEQYDVQQDEwp2
cG4uY3UuZWR1MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxaJb/tXs
RwDzj9ZszdymD+2LokVGNDkhN0LZZ23qGd+1UgJCnmd+ix4DgzPKv78snT1yb7yR
W21R7BqqphEOB01ZNxsX22DB7Zr73W+U7auCCqt1naNmHYdJCx88z/EckCM8cJNq
OGKrf7kjkFAMUlezZczB6+aDNY8oVsFRM8ZEkSQgGDPGvrQh7qX3r8/6//IukE9T
UNMAyiWu0ZysjtKattgN0DK+9UC+CEhFvWyh+52WxRzbQ0z9HHAhKL9l51/0WXIo
3Q9Osxy70Qz7vS7QW2NCCH8/Ibqq5Sq/VzyZsWpzwI8TDzuAsJI/J2qmLNJIidNC
Dkhe7XZvKmNhpQIDAQABo4IC2zCCAtcwHwYDVR0jBBgwFoAUmvMr2s+tT7YvuypI
SCoStxtCwSQwHQYDVR0OBBYEFLeG9vInkf5jYD+G4wz6Nr/kqeRnMA4GA1UdDwEB
/wQEAwIFoDAMBgNVHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEF
BQcDAjBQBgNVHSAESTBHMDsGDCsGAQQBsjEBAgEDBDArMCkGCCsGAQUFBwIBFh1o
dHRwczovL3NlY3VyZS5jb21vZG8uY29tL0NQUzAIBgZngQwBAgIwWgYDVR0fBFMw
UTBPoE2gS4ZJaHR0cDovL2NybC5jb21vZG9jYS5jb20vQ09NT0RPUlNBT3JnYW5p
emF0aW9uVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNybDCBiwYIKwYBBQUHAQEE
fzB9MFUGCCsGAQUFBzAChklodHRwOi8vY3J0LmNvbW9kb2NhLmNvbS9DT01PRE9S
U0FPcmdhbml6YXRpb25WYWxpZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3J0MCQGCCsG
AQUFBzABhhhodHRwOi8vb2NzcC5jb21vZG9jYS5jb20wggEaBgNVHREEggERMIIB
DYIKdnBuLmN1LmVkdYIScDAxdnBuLnByb2QuY3UuZWR1ghRwMDF2cG4wMS5wcm9k
LmN1LmVkdYIUcDAxdnBuMDIucHJvZC5jdS5lZHWCEHAwM3Zwbi5hZC5jdS5lZHWC
EnAwM3ZwbjAxLmFkLmN1LmVkdYIScDAzdnBuMDIuYWQuY3UuZWR1gg12cG4uY3Vz
eXMuZWR1ggx2cG4wMS5jdS5lZHWCD3ZwbjAxLmN1c3lzLmVkdYIMdnBuMDIuY3Uu
ZWR1gg92cG4wMi5jdXN5cy5lZHWCC3ZwbjEuY3UuZWR1gg52cG4xLmN1c3lzLmVk
dYILdnBuMi5jdS5lZHWCDnZwbjIuY3VzeXMuZWR1MA0GCSqGSIb3DQEBCwUAA4IB
AQBJk1HJbRghqLnn97LOfeuam6p/5D9Kt5WWFHZI7PWotXGsFC9pXjPX2rEjkqLY
8fxJ3qHAqkWMoZ6TKwABJGp+Jl5fS75kjxhd5nv7QG9onVJKNWABFkBeUZULmRN2
yWl3bxUOmti6t0VOSJp3sioMnynB+4bGMBQbyXIR85DdBboYkL7bka/QkkWIy52/
1oL2g3lGCPrYZfs7UZxiKmuGwX31dHKo2nbbS2jJdAvPK/HcMR+M60wwlIbbzT7V
FcpEAZ/1tcQxzk7b4aDCqxSyQwTh6SupRDXECUcZbgogXYKLoO0wuy9jWYEBcswC
Q7FVCLc4EFPwz9tkdLE2N13o
-----END CERTIFICATE-----''';

  var pkcs7 = '''-----BEGIN PKCS7-----
MIIQcAYJKoZIhvcNAQcCoIIQYTCCEF0CAQExADALBgkqhkiG9w0BBwGgghBFMIIG
NDCCBRygAwIBAgIQA5d+S+3rXyfS19Bvm94qCTANBgkqhkiG9w0BAQsFADBlMQsw
CQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cu
ZGlnaWNlcnQuY29tMSQwIgYDVQQDExtEaWdpQ2VydCBTSEEyIEFzc3VyZWQgSUQg
Q0EwHhcNMjAxMDE2MDAwMDAwWhcNMjExMDEzMjM1OTU5WjBQMSMwIQYDVQQDDBpk
cG0tcHRzcEBqYXlhcHVyYWthYi5nby5pZDEpMCcGCSqGSIb3DQEJARYaZHBtLXB0
c3BAamF5YXB1cmFrYWIuZ28uaWQwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIK
AoICAQC/wFGpi9AwmkSyywd0wt7eeEiLRwV3cVeCy04RVqucsRNEUTzqEPyiqmWY
pJqLxwGpWwXZoNvFcBLW64Rw1ztLlm77tD+RAPNhzJLU26wLwIMDzAk/l9GJJGof
+FydLeVNv08DRcgUhrxhVfINxdLVGTAUAct6rUqNONoJuArbpHEyqrpIyOlMP9I2
6R5Z5l9zHja54xV/IBjd2PLGfVyS7yK5xpVD5DBBY1HSrmpv2VLQqHgj2FjN09gi
YARD3KBLiFFe+Nrfz9ZE2PaVnTSQuGpqNc2AKo+kWCpDkP5JhqXGcegze1SmktyD
xsZlahQl9HoqT2AXqV50sTkpYoJ6lXej2QJmIohgCZ4P9sea/m2nGl98a6N2dDjH
ip4Z0aiNd3pxBNWSDZzSLBErmMqHk593igFQAlSl++XmWEXcjPu1a9W5G8dnKx3F
mh82INvhcRBV2GOcyrUtuwq1/pNVCHj5TZI6nOJZvCLZ5+YjlTBei+WYs0JLt9mi
DMqlNl9S5Ne4VzSO8gFlNVmi5Pq0Qd5SbBwpNH6uX4t3XBdgbpjl3iUzmITCwOXr
83bYW4UO3vM4cvUVvpV1Xfi9mzn98SEkO/pVlMriEIyIPPGQUo2rHyDqu8K9cVjv
UVvn3VCOksrWu4IAQ7IgIPXIz5w1ZdvzTX2CoUt7i1lwIgFhPwIDAQABo4IB8zCC
Ae8wHwYDVR0jBBgwFoAU5wIjgABP2Ne8lAvZP3Q5STI8inkwHQYDVR0OBBYEFOTE
Vh4L+uhI5dqscptHTaHKfCJAMAwGA1UdEwEB/wQCMAAwJQYDVR0RBB4wHIEaZHBt
LXB0c3BAamF5YXB1cmFrYWIuZ28uaWQwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQW
MBQGCCsGAQUFBwMEBggrBgEFBQcDAjBDBgNVHSAEPDA6MDgGCmCGSAGG/WwEAQEw
KjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCBiAYD
VR0fBIGAMH4wPaA7oDmGN2h0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2Vy
dFNIQTJBc3N1cmVkSURDQS1nMy5jcmwwPaA7oDmGN2h0dHA6Ly9jcmw0LmRpZ2lj
ZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDQS1nMy5jcmwweQYIKwYBBQUH
AQEEbTBrMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wQwYI
KwYBBQUHMAKGN2h0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNI
QTJBc3N1cmVkSURDQS5jcnQwDQYJKoZIhvcNAQELBQADggEBAFAWK/KzQwm3zSTO
t++g639QFmTcdK8AFHBbzB8cl44XaXBce4CwqsMF+7sMw58ehWFkzU9ogxbYiUdm
/u04DWdMIH+gdg3d7DFfT7D0UGRAnHJYbdfGSCVHI8pfgFz9Q52+NPbykcAyLd4Z
xO97qqmq+7Xuqp+j1JdmrwTtuqkDNc4wr+ET4ibuqWbcYSGxM3/fpV2MGSp5OTY6
qHu0eLB6ogCJMwr4/cpgtm70NkPqeM3KQI1usTwU5z09vrHhl/1cGfauCNCow927
UzcQLh7HMeo9DWZ4cDVUBw+lczfEgAUU1DqWKr3PLYenmc8g1APaqfW4cStwcQ/G
s+8JTj8wggZOMIIFNqADAgECAhAErnlgZmaQGrnFf6ZsW9zNMA0GCSqGSIb3DQEB
CwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNV
BAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNVBAMTG0RpZ2lDZXJ0IEFzc3VyZWQg
SUQgUm9vdCBDQTAeFw0xMzExMDUxMjAwMDBaFw0yODExMDUxMjAwMDBaMGUxCzAJ
BgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5k
aWdpY2VydC5jb20xJDAiBgNVBAMTG0RpZ2lDZXJ0IFNIQTIgQXNzdXJlZCBJRCBD
QTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANz4ESM/arXvwCd5Gy0F
h6IQQzHfDtQVG093pCLOPoxw8L4Hjt0nKrwBHbYsCsrdaVgfQe1qBR/aY3hZHiIs
K/i6fsk1O1bxH3xCfiWwIxnGRTjXPUT5IHxgrhywWhgEvo8796nwlJqmDGNJtkEX
U0AyvU/mUHpQHyVF6PGJr83/Xv9Q8/AXEf+9xYn1vWK52PuORQSFbZnNxUhN/Sar
AjZF6jbXX2riGoJBCtzp2fWRF47GIa04PBPmHn9mnNVN2Uba9s9Sp307JMO0wVE1
xpvr1O9+5HsD4US9egs34E/LgooNcRjkpuCJLBvzsnM8wbCSnhh9vat9xX0IoSzC
n3MCAwEAAaOCAvgwggL0MBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQD
AgGGMDQGCCsGAQUFBwEBBCgwJjAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGln
aWNlcnQuY29tMIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsNC5kaWdpY2Vy
dC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8v
Y3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0G
A1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDBDCCAbMGA1UdIASCAaowggGmMIIB
ogYKYIZIAYb9bAACBDCCAZIwKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LmRpZ2lj
ZXJ0LmNvbS9DUFMwggFkBggrBgEFBQcCAjCCAVYeggFSAEEAbgB5ACAAdQBzAGUA
IABvAGYAIAB0AGgAaQBzACAAQwBlAHIAdABpAGYAaQBjAGEAdABlACAAYwBvAG4A
cwB0AGkAdAB1AHQAZQBzACAAYQBjAGMAZQBwAHQAYQBuAGMAZQAgAG8AZgAgAHQA
aABlACAARABpAGcAaQBDAGUAcgB0ACAAQwBQAC8AQwBQAFMAIABhAG4AZAAgAHQA
aABlACAAUgBlAGwAeQBpAG4AZwAgAFAAYQByAHQAeQAgAEEAZwByAGUAZQBtAGUA
bgB0ACAAdwBoAGkAYwBoACAAbABpAG0AaQB0ACAAbABpAGEAYgBpAGwAaQB0AHkA
IABhAG4AZAAgAGEAcgBlACAAaQBuAGMAbwByAHAAbwByAGEAdABlAGQAIABoAGUA
cgBlAGkAbgAgAGIAeQAgAHIAZQBmAGUAcgBlAG4AYwBlAC4wHQYDVR0OBBYEFOcC
I4AAT9jXvJQL2T90OUkyPIp5MB8GA1UdIwQYMBaAFEXroq/0ksuCMS1Ri6enIZ3z
bcgPMA0GCSqGSIb3DQEBCwUAA4IBAQBO1Iknuf0dh3d+DygFkPEKL8k7Pr2TnJDG
r/qRUYcyVGvoysFxUVyZjrX64GIZmaYHmnwTJ9vlAqKEEtkV9gpEV8Q0j21zHzrW
oAE93uOC5EVrsusl/YBeHTmQvltC9s6RYOP5oFYMSBDOM2h7zZOr8GrLT1gPuXtd
GwSBnqci4ldJJ+6Skwi+aQhTAjouXcgZ9FCATgLZsF2RtJOH+ZaWgVVAjmbtgti7
KF/tTGHtBlgoGVMRRLxHICmyBGzYiVSZO3XbZ3gsHpJ4xlU9WBIRMm69QwxNNNt7
xkLb7L6rm2FMBpLjjt8hKlBXBMBgojXVJJ5mNwlJz9X4ZbPg4m7CMIIDtzCCAp+g
AwIBAgIQDOfg5RfYRv6P5WD8G/AwOTANBgkqhkiG9w0BAQUFADBlMQswCQYDVQQG
EwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNl
cnQuY29tMSQwIgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJvb3QgQ0EwHhcN
MDYxMTEwMDAwMDAwWhcNMzExMTEwMDAwMDAwWjBlMQswCQYDVQQGEwJVUzEVMBMG
A1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSQw
IgYDVQQDExtEaWdpQ2VydCBBc3N1cmVkIElEIFJvb3QgQ0EwggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQCtDhXO5EOAXLGH87dg+XESpa7cJpSIqvTO9SA5
KFhgDPiA2qkVlTJhPLWxKISKityfCgyDF3qPkKyK53lTXDGEKvYPmDI2dsze3Tyo
ou9q+yHyUmHfnyDXH+Kx2f4YZNISW1/5WBg1vEfNoTb5a3/UsDg+wRvDjDPZ2C8Y
/igPs6eD1sNuRMBhNZYW/lmci3Zt1/GiSw0r/wty2p5g0I6QNcZ4VYcgoc/lbQrI
SXwxmDNsIumH0DJaoroTghHtORedmTpyoeb6pNnVFzF1roV9Iq4/AUaG9ih5yLHa
5FcXxH4cDrC0kqZWs72yl+2qp/C3xag/lRbQ/6GW6whfGHdPAgMBAAGjYzBhMA4G
A1UdDwEB/wQEAwIBhjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBRF66Kv9JLL
gjEtUYunpyGd823IDzAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYunpyGd823IDzAN
BgkqhkiG9w0BAQUFAAOCAQEAog683+Lt8ONyc3pklL/3cmbYMuRCdWKuh+vy1dne
VrOfzM4UKLkNl2BcEkxY5NM9g0lFWJc1aRqoR+pWxnmrEthngYTffwk8lOa4Jiwg
vT2zKIn3X/8i4peEH+ll74fg38FnSbNd67IJKusm7Xi+fT8r87cmNW1fiQG2SVuf
AQWbqz0lwcy2f8Lxb4bG+mRo64EtlOtCt/qMHt1i8b5QZ7dsvfPxH2sMNgcWfzd8
qVttevESRmCD1ycEvkvOl77DZypoEd+A5wwzZr8TDRRu838fYxAe+o0bJW1sj6W3
YQGx0qMmoRBxna3iw/nDmVG3KwcIzi7mULKn+gpFL6Lw8jEA
-----END PKCS7-----''';

  var oscpEnd = '''-----BEGIN CERTIFICATE-----
MIIL3TCCCsWgAwIBAgIMb5wBeBwhgDIlSnMrMA0GCSqGSIb3DQEBCwUAMGIxCzAJ
BgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMTgwNgYDVQQDEy9H
bG9iYWxTaWduIEV4dGVuZGVkIFZhbGlkYXRpb24gQ0EgLSBTSEEyNTYgLSBHMzAe
Fw0yMDA5MDIxNTM4MDZaFw0yMTEwMDQxNTM4MDZaMIIBBjEdMBsGA1UEDwwUUHJp
dmF0ZSBPcmdhbml6YXRpb24xDzANBgNVBAUTBjU3ODYxMTETMBEGCysGAQQBgjc8
AgEDEwJVUzEeMBwGCysGAQQBgjc8AgECEw1OZXcgSGFtcHNoaXJlMQswCQYDVQQG
EwJVUzEWMBQGA1UECBMNTmV3IEhhbXBzaGlyZTETMBEGA1UEBxMKUG9ydHNtb3V0
aDEpMCcGA1UECRMgMiBJbnRlcm5hdGlvbmFsIERyaXZlLCBTdWl0ZSAxNTAxHTAb
BgNVBAoTFEdNTyBHbG9iYWxTaWduLCBJbmMuMRswGQYDVQQDExJ3d3cuZ2xvYmFs
c2lnbi5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDhvTs7gJj+
myK4eLHq5Kt95hHCNG2BfLBnMnBZtkJNIX0RNuBUT9aJQTtJk1B4jgLI0x7Jr3N6
wRcD1lnTjgb++lxBdJHD2lpenfqU39NrC13URyuo2nyas3c+o195YZs6RVexoU+5
K/YKkqiJ6A4CNzLNcR3x3R0uN5lWsFHhHeVXjvVSH53F8FCFu2h6++7YDIYzt3MB
IiwFu8B5MQfPxGTDFv/Joa8wPy4fjfqnvxa96jnWoUHALVAgi2QLSldrt9WcypX1
uylwGTrgltV0JeBa+s8UVr001NoJ760kenTpnfGV172xOlIx04MnZ3iqYT1GBlGF
utGnu8EApjyXAgMBAAGjggfrMIIH5zAOBgNVHQ8BAf8EBAMCBaAwgZYGCCsGAQUF
BwEBBIGJMIGGMEcGCCsGAQUFBzAChjtodHRwOi8vc2VjdXJlLmdsb2JhbHNpZ24u
Y29tL2NhY2VydC9nc2V4dGVuZHZhbHNoYTJnM3IzLmNydDA7BggrBgEFBQcwAYYv
aHR0cDovL29jc3AyLmdsb2JhbHNpZ24uY29tL2dzZXh0ZW5kdmFsc2hhMmczcjMw
VQYDVR0gBE4wTDBBBgkrBgEEAaAyAQEwNDAyBggrBgEFBQcCARYmaHR0cHM6Ly93
d3cuZ2xvYmFsc2lnbi5jb20vcmVwb3NpdG9yeS8wBwYFZ4EMAQEwCQYDVR0TBAIw
ADBFBgNVHR8EPjA8MDqgOKA2hjRodHRwOi8vY3JsLmdsb2JhbHNpZ24uY29tL2dz
L2dzZXh0ZW5kdmFsc2hhMmczcjMuY3JsMIIFKQYDVR0RBIIFIDCCBRyCEnd3dy5n
bG9iYWxzaWduLmNvbYINZ2xvYmFsc2lnbi5iZYINZ2xvYmFsc2lnbi5jaIIQZ2xv
YmFsc2lnbi5jby51a4IRZ2xvYmFsc2lnbi5jb20uYXWCEWdsb2JhbHNpZ24uY29t
LmhrghFnbG9iYWxzaWduLmNvbS5zZ4INZ2xvYmFsc2lnbi5lc4INZ2xvYmFsc2ln
bi5ldYINZ2xvYmFsc2lnbi5mcoIOZ2xvYmFsc2lnbi5uZXSCDWdsb2JhbHNpZ24u
bmyCFXNlY3VyZS5nbG9iYWxzaWduLm5ldIIRd3d3Lmdsb2JhbHNpZ24uYmWCEXd3
dy5nbG9iYWxzaWduLmNoghR3d3cuZ2xvYmFsc2lnbi5jby51a4IVd3d3Lmdsb2Jh
bHNpZ24uY29tLmF1ghV3d3cuZ2xvYmFsc2lnbi5jb20uaGuCFXd3dy5nbG9iYWxz
aWduLmNvbS5zZ4IRd3d3Lmdsb2JhbHNpZ24uZXOCEXd3dy5nbG9iYWxzaWduLmV1
ghF3d3cuZ2xvYmFsc2lnbi5mcoISd3d3Lmdsb2JhbHNpZ24ubmV0ghF3d3cuZ2xv
YmFsc2lnbi5ubIIiY2VydGlmaWVkLXRpbWVzdGFtcC5nbG9iYWxzaWduLmNvbYIV
Y2xpZW50Lmdsb2JhbHNpZ24uY29tghFjbi5nbG9iYWxzaWduLmNvbYIbY3RsMS5l
cGtpcHJvLmdsb2JhbHNpZ24uY29tghdjdGwxLmhjcy5nbG9iYWxzaWduLmNvbYIa
Y3RsMS5zeXN0ZW0uZ2xvYmFsc2lnbi5jb22CF2N0bDIuaGNzLmdsb2JhbHNpZ24u
Y29tghpjdGwyLnN5c3RlbS5nbG9iYWxzaWduLmNvbYIYZG93bmxvYWRzLmdsb2Jh
bHNpZ24uY29tghVlLXNpZ24uZ2xvYmFsc2lnbi5jb22CEmVkaS5nbG9iYWxzaWdu
LmNvbYIWZXBraXByby5nbG9iYWxzaWduLmNvbYISaGNzLmdsb2JhbHNpZ24uY29t
ghFoay5nbG9iYWxzaWduLmNvbYITaW5mby5nbG9iYWxzaWduLmNvbYIRanAuZ2xv
YmFsc2lnbi5jb22CFG9jbmdzLmdsb2JhbHNpZ24uY29tghhvcGVyYXRpb24uZ2xv
YmFsc2lnbi5jb22CFnBhcnRuZXIuZ2xvYmFsc2lnbi5jb22CFnByb2ZpbGUuZ2xv
YmFsc2lnbi5jb22CFXJlZ2lzdC5nbG9iYWxzaWduLmNvbYIgcmZjMzE2MS10aW1l
c3RhbXAuZ2xvYmFsc2lnbi5jb22CH3JmYzMxNjF0aW1lc3RhbXAuZ2xvYmFsc2ln
bi5jb22CE3NlYWwuZ2xvYmFsc2lnbi5jb22CFXNlY3VyZS5nbG9iYWxzaWduLmNv
bYITc2hvcC5nbG9iYWxzaWduLmNvbYIVc29jaWFsLmdsb2JhbHNpZ24uY29tghRz
c2lmMS5nbG9iYWxzaWduLmNvbYIXc3NsY2hlY2suZ2xvYmFsc2lnbi5jb22CFnN0
YXRpYzEuZ2xvYmFsc2lnbi5jb22CFnN0YXRpYzIuZ2xvYmFsc2lnbi5jb22CFXN0
YXR1cy5nbG9iYWxzaWduLmNvbYIWc3VwcG9ydC5nbG9iYWxzaWduLmNvbYIVc3lz
dGVtLmdsb2JhbHNpZ24uY29tghF0aC5nbG9iYWxzaWduLmNvbYIOZ2xvYmFsc2ln
bi5jb20wHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1UdIwQYMBaA
FN2z522oLujFTm7PdOZ1PJQVzugdMB0GA1UdDgQWBBSgOHv0jCH3JdmJRT1GPHUm
/YbYmjCCAQUGCisGAQQB1nkCBAIEgfYEgfMA8QB3AFzcQ5L+5qtFRLFemtRW5hA3
+9X6R9yhc5SyXub2xw7KAAABdE934ncAAAQDAEgwRgIhAJdVkn+p4Vrdj3D9hIOJ
PDpXuxHUTzpYc/BxjLqNcKpxAiEAjlsIW2P9AFvcBqfP1dBr786hV/CiRdSyKMZC
SBNcjk8AdgD2XJQv0XcwIhRUGAgwlFaO400TGTO/3wwvIAvMTvFk4wAAAXRPd+Bk
AAAEAwBHMEUCIQD9NYOUtCekrFwmGCVGNYzgxWWWRAy2QKsOfHdEjeKr8wIgM7po
kojeuRXEMP8bnm1A7S57j1/2Wcov1U871fX4wUowDQYJKoZIhvcNAQELBQADggEB
AENL058pRO/HflqUeXSX4aZvqf9mx6mQi/ff5WA1BRvUg6BFNr2hXc7XpAz6vV7U
DYcxZFw6C6lvOV0tQfdMWGG+j+jhT7MWQigHqtXTBw6ddTEuzu/6p3mY3kZLX1KZ
hTYatwBg/mcSlRzHGaU3c/qn4HCKa9na2QaFOWEffGh51jUlm2/8uRcFUuLS+kcX
qPCnVC2eHELqtjLEZCW+qNNkxT/8LRLYmgYDTGYAGWaILIfX25m3CEtABfzvcSF1
dYjAOknKCA552jYfC0FCIUZjx1K52SEXQCviQpZ/tJToBCwTxzUhiN3rum+FtKuL
uhB087agCDUo8J7k5jRtrNM=
-----END CERTIFICATE-----''';

  var ocspInter = '''-----BEGIN CERTIFICATE-----
MIIEYTCCA0mgAwIBAgIOSKQC3SeSDaIINJ3RmXswDQYJKoZIhvcNAQELBQAwTDEg
MB4GA1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2Jh
bFNpZ24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMTYwOTIxMDAwMDAwWhcNMjYw
OTIxMDAwMDAwWjBiMQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBu
di1zYTE4MDYGA1UEAxMvR2xvYmFsU2lnbiBFeHRlbmRlZCBWYWxpZGF0aW9uIENB
IC0gU0hBMjU2IC0gRzMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCr
awNnVNXcEfvFohPBjBkn3BB04mGDPfqO24+lD+SpvkY/Ar5EpAkcJjOfR0iBFYhW
N80HzpXYy2tIA7mbXpKu2JpmYdU1xcoQpQK0ujE/we+vEDyjyjmtf76LLqbOfuq3
xZbSqUqAY+MOvA67nnpdawvkHgJBFVPnxui45XH4BwTwbtDucx+Mo7EK4mS0Ti+P
1NzARxFNCUFM8Wxc32wxXKff6WU4TbqUx/UJm485ttkFqu0Ox4wTUUbn0uuzK7yV
3Y986EtGzhKBraMH36MekSYlE473GqHetRi9qbNG5pM++Sa+WjR9E1e0Yws16CGq
smVKwAqg4uc43eBTFUhVAgMBAAGjggEpMIIBJTAOBgNVHQ8BAf8EBAMCAQYwEgYD
VR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQU3bPnbagu6MVObs905nU8lBXO6B0w
HwYDVR0jBBgwFoAUj/BLf6guRSSuTVD6Y5qL3uLdG7wwPgYIKwYBBQUHAQEEMjAw
MC4GCCsGAQUFBzABhiJodHRwOi8vb2NzcDIuZ2xvYmFsc2lnbi5jb20vcm9vdHIz
MDYGA1UdHwQvMC0wK6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9v
dC1yMy5jcmwwRwYDVR0gBEAwPjA8BgRVHSAAMDQwMgYIKwYBBQUHAgEWJmh0dHBz
Oi8vd3d3Lmdsb2JhbHNpZ24uY29tL3JlcG9zaXRvcnkvMA0GCSqGSIb3DQEBCwUA
A4IBAQBVaJzl0J/i0zUV38iMXIQ+Q/yht+JZZ5DW1otGL5OYV0LZ6ZE6xh+WuvWJ
J4hrDbhfo6khUEaFtRUnurqzutvVyWgW8msnoP0gtMZO11cwPUMUuUV8iGyIOuIB
0flo6G+XbV74SZuR5v5RAgqgGXucYUPZWvv9AfzMMQhRQkr/MO/WR2XSdiBrXHoD
L2xk4DmjA4K6iPI+1+qMhyrkUM/2ZEdA8ldqwl8nQDkKS7vq6sUZ5LPVdfpxJZZu
5JBj4y7FNFTVW1OMlCUvwt5H8aFgBMLFik9xqK6JFHpYxYmf4t2sLLxN0LlCthJE
abvp10ZlOtfu8hL5gCXcxnwGxzSb
-----END CERTIFICATE-----''';

  var ocspResponse =
      'MIIFxgoBAKCCBb8wggW7BgkrBgEFBQcwAQEEggWsMIIFqDCBmqIWBBQhKQoVCN15AXyjxhHpv4ozglPEDBgPMjAyMTA4MTExMDEzNDRaMG8wbTBFMAkGBSsOAwIaBQAEFJxMcRXDAhnKNty5iyEzAEykp47TBBTds+dtqC7oxU5uz3TmdTyUFc7oHQIMb5wBeBwhgDIlSnMrgAAYDzIwMjEwODExMTAxMzQ0WqARGA8yMDIxMDgxNTEwMTM0NFowDQYJKoZIhvcNAQELBQADggEBACnhEigwmP9klp9f/AZXIFUtWIdOJmVS2M/wjuxjiR+50TPuPYysiExnYj3lf3ZM5cAK2UVvdTOhOfDBG13waLDb7J2r3Iyfd1DRubjIz8UtEOZe3Nh3DrhAYgHLXAlEWYhTQgibg50hQW8piTEb8jCX2Ice7JHPQn/x3GbZBU5MqAPYDrjCanpHyO2VDMhsViWP6BFRx7jReRph9u0JWaxbGoKWZ7vHIoZxsTUpktrlXAk5MzccDy8cbWLz81BajDE1E39iwiEa0A1j1j+OhrD6T0nLcYyqctd+aQI406Xr+BrvyX4eGYi2UWfsdnoi5KCiyu4BaZ1K4wNcB80zG0GgggPzMIID7zCCA+swggLToAMCAQICDExHmYumt6CDjKqQyzANBgkqhkiG9w0BAQsFADBiMQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTE4MDYGA1UEAxMvR2xvYmFsU2lnbiBFeHRlbmRlZCBWYWxpZGF0aW9uIENBIC0gU0hBMjU2IC0gRzMwHhcNMjEwNzI4MTAyNTE4WhcNMjExMDI4MTAyNTE3WjCBijELMAkGA1UEBhMCU0cxGzAZBgNVBAoTEkdsb2JhbFNpZ24gUHRlIEx0ZDEVMBMGA1UEBRMMMjAxOTA2MTMwMDA4MUcwRQYDVQQDEz5HbG9iYWxTaWduIEV4dGVuZGVkIFZhbGlkYXRpb24gQ0EgLSBTSEEyNTYgLSBHMyBPQ1NQIHJlc3BvbmRlcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAME720lBGu4snNoi0CA3izovZjHiwqubFWHOXvnF4cJ3ckrrlpEFfdYXLZ+fH+vNLj3/Bvwm4ZWuccetsh5NJUhtxfYXQu4tY/zQjEFXG47kCbIRV49C0aJpmeSvqong0qhCoZOkBqlbLwaAzxmCgFMSNaNMglqWshbKBZCvCKrtl1X2CL/10ZypY680R6nETZTDwZhUo5t2uCdJEb2bd3VSZ2slVaVrOP6hEa/2PLWsj8SzpE/NMAB0coaA8nDctfXPjTmZgM4ip/6R7mCfppyGlgIzxegI5H0AARHPTBil9vZoNowbDDt3LR23pnGgk1SiHGYyr+oIakCwQmdNMxUCAwEAAaN4MHYwHwYDVR0jBBgwFoAU3bPnbagu6MVObs905nU8lBXO6B0wDwYJKwYBBQUHMAEFBAIFADATBgNVHSUEDDAKBggrBgEFBQcDCTAdBgNVHQ4EFgQUISkKFQjdeQF8o8YR6b+KM4JTxAwwDgYDVR0PAQH/BAQDAgeAMA0GCSqGSIb3DQEBCwUAA4IBAQCjZW4xOUr6U9jmHS/nnvI/3ZsodsGvhC5BNE+AOSdOmGVSMU5qzVKpTWHxME+k8XUJxcIgh+1kCl2vTOFCrNF4aMDxWjoZwcmCJlehLNp0rU1/MHwHQHzGk11F7D73q4+AGoX8YF3VV5hCywJYHheS4iaTvupuwdsOD++sAKD7/KyUEL/CsADtwr/SKHNTto9vj5TAglUb/cDFHXsDpXhP9sS6dckbKsz+oYvtgR2zMQv4ehXppvwE3cHYR5RoTt2HZddB4uSav4OaQTVjEhWPOFKoqNzSlrfM333IyoRvTcCifzoJPaof2zWH4hhSpyEiXSoshJag1qRm4K9Bwd+V';

  var ocspResponse2 =
      'MIIB5goBAKCCAd8wggHbBgkrBgEFBQcwAQEEggHMMIIByDCBsaIWBBSljP4yzOsPLNQZxgi4ACSIXcPFtxgPMjAyMTA4MTExMTU0NThaMIGFMIGCMEkwCQYFKw4DAhoFAAQUc4Sn0GLAB0GWQ82/EbUOT4LE40EEFKWM/jLM6w8s1BnGCLgAJIhdw8W3AhAEv3crr1ZmySqLla9KGkYWoREYDzIwMjEwNTAyMTkyMTQ2WhgPMjAyMTA4MTExMTM5MDJaoBEYDzIwMjEwODE4MTA1NDAyWjANBgkqhkiG9w0BAQsFAAOCAQEAR4UMbB5wOiaiLqhmpcVZZTL2fGKDzxKxgG4U6J7NR12czlbbwhYy7taKw9etiw87l3wkbP6H/mgYN6NIVHH2DDhJJJXWKPuSaWY+K6g8bz4aIKGUnWKyfFiP8NWECTZiMgeNMRDI5sR/NrM2aekRHPWPC8In+2NxsZqvSvRhQGJbixEfHOvAX2bJUf0soIr+4WpoWxppqBKVafnwPoAsh6UB/Ks8MuSy89dIo4DfLQll1T2FkY0BtA1c2vx3Wyg0BzbWFnfK0Z0nRo9NBjoLvw/4pimos46DvVbtxebT/cmOhLwtjJUJ59UVzbUfEwYyB7WCUG5jT4EYodp9nwOsog==';

  var ocspResponse3 = 'MAMKAQY=';
  test('Test getBytesFromPEMString', () {
    var bytes = CryptoUtils.getBytesFromPEMString(csr);
    var formatted = X509Utils.formatKeyString(
        base64Encode(bytes), X509Utils.BEGIN_CSR, X509Utils.END_CSR);
    expect(formatted, csr);
  });

  test('Test formatKeyString', () {
    var formatted = X509Utils.formatKeyString(
        unformattedKey, X509Utils.BEGIN_CSR, X509Utils.END_CSR);
    expect(formatted, csr);
  });

  test('Test encodeDN', () {
    var dn = {
      'CN': 'basic-utils.dev',
      'O': 'Magic Company',
      'L': 'Fakecity',
      'S': 'FakeState',
      'C': 'DE',
    };
    var object = X509Utils.encodeDN(dn) as ASN1Sequence;
    expect(object.elements!.length, 5);
  });

  test('Test privateKeyFromASN1Sequence', () {
    var pair = CryptoUtils.generateRSAKeyPair();

    var privateKey =
        CryptoUtils.encodeRSAPrivateKeyToPem(pair.privateKey as RSAPrivateKey);
    var bytes = CryptoUtils.getBytesFromPEMString(privateKey);
    var asn = ASN1Parser(bytes).nextObject() as ASN1Sequence;
    var objects = asn.elements!;
    var string = objects[2] as ASN1OctetString;
    var object = X509Utils.privateKeyFromASN1Sequence(
        ASN1Parser(string.valueBytes).nextObject() as ASN1Sequence);
    expect(object.n!.bitLength, 2048);
  });

  test('Test encodeASN1ObjectToPem', () {
    var topLevelSeq = ASN1Sequence();
    topLevelSeq.add(ASN1Integer(BigInt.from(0)));
    var pem = X509Utils.encodeASN1ObjectToPem(
        topLevelSeq, '-----BEGIN PUBLIC KEY-----', '-----END PUBLIC KEY-----');
    expect(
        pem, '-----BEGIN PUBLIC KEY-----\nMAMCAQA=\n-----END PUBLIC KEY-----');
  });

  test('Test generateRsaCsrPem', () {
    var pair = CryptoUtils.generateRSAKeyPair();
    var dn = {
      'CN': 'basic-utils.dev',
      'O': 'Magic Company',
      'L': 'Fakecity',
      'S': 'FakeState',
      'C': 'DE',
    };
    var csr = X509Utils.generateRsaCsrPem(
        dn, pair.privateKey as RSAPrivateKey, pair.publicKey as RSAPublicKey);
    var bytes = CryptoUtils.getBytesFromPEMString(csr);
    var sequence = ASN1Sequence.fromBytes(bytes);
    var e1 = sequence.elements!.elementAt(0) as ASN1Sequence;
    var e2 = e1.elements!.elementAt(1) as ASN1Sequence;
    var e3 = e2.elements!.elementAt(0) as ASN1Set;
    var e4 = e3.elements!.elementAt(0) as ASN1Sequence;
    var e5 = e4.elements!.elementAt(1) as ASN1UTF8String;
    var cn = e5.utf8StringValue;
    expect(cn, 'basic-utils.dev');
  });

  test('Test generateEccCsrPem', () {
    var pair = CryptoUtils.generateEcKeyPair();
    var dn = {
      'CN': 'basic-utils.dev',
      'O': 'Magic Company',
      'L': 'Fakecity',
      'S': 'FakeState',
      'C': 'DE',
    };
    var csr = X509Utils.generateEccCsrPem(
        dn, pair.privateKey as ECPrivateKey, pair.publicKey as ECPublicKey);
    var bytes = CryptoUtils.getBytesFromPEMString(csr);
    var sequence = ASN1Sequence.fromBytes(bytes);
    var e1 = sequence.elements!.elementAt(0) as ASN1Sequence;
    var e2 = e1.elements!.elementAt(1) as ASN1Sequence;
    var e3 = e2.elements!.elementAt(0) as ASN1Set;
    var e4 = e3.elements!.elementAt(0) as ASN1Sequence;
    var e5 = e4.elements!.elementAt(1) as ASN1UTF8String;
    var cn = e5.utf8StringValue;
    expect(cn, 'basic-utils.dev');
  });

  test('Test generateKeyPair', () {
    var pair = CryptoUtils.generateRSAKeyPair();
    var private = pair.privateKey as RSAPrivateKey;
    var public = pair.publicKey as RSAPublicKey;
    expect(private.n!.bitLength, 2048);
    expect(public.n!.bitLength, 2048);
  });

  test('Test x509CertificateFromPem', () {
    var data = X509Utils.x509CertificateFromPem(x509Pem);
    expect(data.version, 2);

    expect(
        data.serialNumber.toString(), '9419718410412351084484106081643920776');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.11');

    expect(data.issuer.containsKey('2.5.4.6'), true);
    expect(data.issuer['2.5.4.6'], 'US');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'OEM Test');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(data.issuer['2.5.4.3'], 'Full OEM Test RSA Sub');

    expect(
        data.validity.notBefore.toIso8601String(), '2019-03-11T00:00:00.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2020-03-10T12:00:00.000Z');

    expect(data.subject.containsKey('2.5.4.3'), true);
    expect(data.subject['2.5.4.3'], 'junkdragons.de');

    expect(data.sha1Thumbprint, '1F6254CEDA7E9E9AEBF8B687BDFB5CC03AD1B3E7');
    expect(data.md5Thumbprint, '4CBED02D6CF2F161540A3177A55F94F6');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        'EEBEB3DA65F238F829F0977BBF409395099704CB');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '3082010A0282010100C31AFEFEDA8432456BC502DED4C6D010241EB36A37A0CEB96F2CB678F8F86126DEB06920D6E883D5EC7E2E22F80BDDC1CFEBC02401397ED9F5B40843F2DA2DEF3B6ED50EDC4CA76A1393F21D3ED55B36D641B2378588D573AFB65A0FACF4BB8D562C441B477E029A559B820CDADD24B4B6F3D70F4D982690F3FD09B8DE1CF49BE489D0869EB0033B6F5B536E6942C60DEB9BE095894F704EC23D794BCE099223292DC4DCC55C449653082699329F0930A72D01EE01F7446E9C66E9BEC62F5A8E16E1440C142558719A78EC515E59C527AB1D379EB49D3F72C410F71E3D5B11C4F781A6DB19CDBCBD59FED273650DCD36521A3CF196922D81776C8CBE07891FD50203010001');

    var sans = data.subjectAlternativNames!;
    expect(sans.length, 3);
    expect(sans.elementAt(0), 'junkdragons.de');
    expect(sans.elementAt(1), 'www.junkdragons.de');
    expect(sans.elementAt(2), 'api.junkdragons.de');
  });

  test('Test x509CertificateFromPem with IP Sans', () {
    var data = X509Utils.x509CertificateFromPem(X509WithSans);
    var sans = data.subjectAlternativNames!;
    expect(sans.length, 2);
    expect(sans.elementAt(0), 'api.ephenodrom.de');
    expect(sans.elementAt(1), '192.168.0.1');

    data = X509Utils.x509CertificateFromPem(X509WithIpSans);
    sans = data.subjectAlternativNames!;
    expect(sans.length, 2);
    expect(sans.elementAt(0), '127.0.0.1');
    expect(sans.elementAt(1), '0.0.0.0');
  });

  test('Test x509CertificateFromPem with V1 X509', () {
    var data = X509Utils.x509CertificateFromPem(x509PemV1);
    expect(data.version, 1);

    expect(data.serialNumber.toString(),
        '206684696279472310254277870180966723415');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.5');

    expect(data.issuer.containsKey('2.5.4.6'), true);
    expect(data.issuer['2.5.4.6'], 'US');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'VeriSign, Inc.');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(data.issuer['2.5.4.3'],
        'VeriSign Class 3 Public Primary Certification Authority - G3');

    expect(
        data.validity.notBefore.toIso8601String(), '1999-10-01T00:00:00.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2036-07-16T23:59:59.000Z');

    expect(data.subject.containsKey('2.5.4.3'), true);
    expect(data.subject['2.5.4.3'],
        'VeriSign Class 3 Public Primary Certification Authority - G3');

    expect(data.sha1Thumbprint, '132D0D45534B6997CDB2D5C339E25576609B5CC6');
    expect(data.md5Thumbprint, 'CD68B6A7C7C4CE75E01D4F5744619209');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        '22F19E2EC6EACCFC5D2346F4C2E8F6C554DD5E07');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '3082010A0282010100CBBA9C52FC781F1A1E6F1B3773BDF8C96B9412304FF03647F5D0910AF517C8A561C116404DFB8A6190E57620C111067DAB2C6EA6F511418EFA2DAD2A6159A467264CD0E8BC525B70200458D17AC9A469BC831764AD058BBCD058CE8D8CF5EBF042490B9D972767326EE1AE93151C70BC204D2F18DE9288E86C8557111AE97EE3261154A245965583CA3089E8DCD8A3ED2A803F7F7965573E152066082F9593BFAA472FA84697F012E2FEC20A2B51E676E6B746B7E20DA6CCA8C34C595589E6E8535C1CEA9DF062160BA7C95F0CF0DEC276CEAFF76AF2FA41A6A23314C9E57A63D39E6237D585659E0EE65324741B5E1D12535BC72CE783493B15AE8A68B957970203010001');
  });

  test('Test x509CertificateFromPem with GeneralizedTime', () {
    var data = X509Utils.x509CertificateFromPem(x509PemWithGeneralizedTime);
    expect(data.version, 2);

    expect(data.serialNumber.toString(),
        '112324828676200291871926431888494945866');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.5');

    expect(data.issuer.containsKey('2.5.4.6'), true);
    expect(data.issuer['2.5.4.6'], 'EE');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'AS Sertifitseerimiskeskus');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(data.issuer['2.5.4.3'], 'EE Certification Centre Root CA');

    expect(
        data.validity.notBefore.toIso8601String(), '2010-10-30T10:10:30.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2030-12-17T23:59:59.000Z');

    expect(data.subject.containsKey('2.5.4.3'), true);
    expect(data.subject['2.5.4.3'], 'EE Certification Centre Root CA');

    expect(data.sha1Thumbprint, 'C9A8B9E755805E58E35377A725EBAFC37B27CCD7');
    expect(data.md5Thumbprint, '435E88D47D1A4A7EFD842E52EB01D46F');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        '30B8B08C3E820AD83B4F1F891EAB29C29C49E937');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '3082010A0282010100C820C0ECE0C54BAB077895F344EEFB0B0CFF748E61BBB162EA23D8ABA165327AEB8E174F96D80A7B91A2636CC78C4C2E79BFA905FC695C958D62F9B970EDC3517DD093E66CEB304BE1BC7DBF529BCE6E7B65F238B1C0A232EF62B268E06153C13695FFEC94BA36AE9C1CA7320FE57CB4C66F74FD7B18E8AC57ED06204B3230585BFDCDA8E6A1FC70BC8E9273DB97A77C21AE3DC1F548876C27BD9F25748155B0F775F63DA4646BD64FE7CE40AD0FDD32D3BC8A125398C989FB101D4D7ECD7E1F560D217085F620831FF6BA1F048FEA778835C4FFEA4EA18B4D3F631B44C344D42576CAB78DD71E4A6664CD5CC59C83E1C208889AEC4EA3F13E1C2CD96C1DA14B0203010001');
  });

  test('Test x509CertificateFromPem with TeletextString', () {
    var data = X509Utils.x509CertificateFromPem(x509PemWithTeletextString);
    expect(data.version, 2);

    expect(data.serialNumber.toString(), '946069240');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.5');

    expect(data.issuer.containsKey('2.5.4.11'), true);
    expect(data.issuer['2.5.4.11'],
        'www.entrust.net/CPS_2048 incorp. by ref. (limits liab.)');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'Entrust.net');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(
        data.issuer['2.5.4.3'], 'Entrust.net Certification Authority (2048)');

    expect(
        data.validity.notBefore.toIso8601String(), '1999-12-24T17:50:51.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2029-07-24T14:15:12.000Z');

    expect(data.subject.containsKey('2.5.4.3'), true);
    expect(
        data.subject['2.5.4.3'], 'Entrust.net Certification Authority (2048)');

    expect(data.sha1Thumbprint, '503006091D97D4F5AE39F7CBE7927D7D652D3431');
    expect(data.md5Thumbprint, 'EE2931BC327E9AE6E8B5F751B4347190');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        'BED60C6DD525D609CA1E3EE48C5D911EF0B95E0D');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '3082010A0282010100AD4D4BA91286B2EAA320071516642A2B4BD1BF0B4A4D8EED8076A567B77840C07342C868C0DB532BDD5EB8769835938B1A9D7C133A0E1F5BB71ECFE524141EB181A98D7DB8CC6B4B03F1020CDCABA54024007F7494A19D0829B3880BF587779D55CDE4C37ED76A64AB851486955B9732506F3DC8BA660CE3FCBDB849C176894919FDC0A8BD89A3672FC69FBC711960B82DE92CC99076667B94E2AF78D665535D3CD69CB2CF2903F92FA450B2D448CE0532558AFDB2644C0EE4980775DB7FDFB9085560853029F97B48A46986E3353F1E865D7A7A15BDEF008E1522541700902693BC0E496891BFF847D39D9542C10E4DDF6F26CFC3182162664370D6D5C007E10203010001');
  });

  test('Test x509CertificateFromPem without CN', () {
    var data = X509Utils.x509CertificateFromPem(certWithoutCN);
    expect(data.version, 2);

    expect(data.serialNumber.toString(), '419432078408221804846119');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.11');

    expect(data.issuer['2.5.4.6'], 'NO');
    expect(data.issuer['2.5.4.10'], 'Buypass AS-983163327');
    expect(data.issuer['2.5.4.3'], 'Buypass Class 2 CA 5');

    expect(
        data.validity.notBefore.toIso8601String(), '2020-09-30T03:18:57.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2021-03-29T21:59:00.000Z');

    expect(data.subject.isEmpty, true);

    expect(data.sha1Thumbprint, '60A66A69269C74F1DDD33EF3CD60E844716974A0');
    expect(data.md5Thumbprint, '29B4F34A5CA1B38A8329A20BFD714CEA');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        'C836ECF35C878C7B51327ECE402641C7A06DF4DE');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '3082010A0282010100C762F36197CAB201EACC8495866301C0ECA2F8158BBE476BE05011F14D64493B831F612898CAAAD4B89A5F88FE379892405924A91167F401903C4FF82DE46AD337421675468FEE24387B971EB4F92D96DC1CBEAD525D47424AB359316A5ABF7E40BFACC4823D14AB49BEC36A4B90343CADA8CBF023705EEB42F9508B7EBF3213292FB35EBBBF0EC2BBE48D0398E6CACEF595C8F748DCA45736925F1D8A8074DDC040895FB6AAF0B8EC233C255F49F9A943F9164813E72CC5F82498CD4EBA51F9B3BC65E87A01C9D566B985F677E5602E0B13C3FF58F63897AFB731786664B23A70544A8C7ADBF93B2A26A53A45467B29D732D3085FF4F96A9567613F705A01F70203010001');
  });

  test('Test x509CertificateFromPem with selfsigned', () {
    var data = X509Utils.x509CertificateFromPem(selfSigned);
    expect(data.version, 2);

    expect(data.serialNumber.toString(), '10');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.11');

    expect(data.issuer.containsKey('2.5.4.6'), true);
    expect(data.issuer['2.5.4.6'], 'RU');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'Hikvision Digital Technology');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(data.issuer['2.5.4.3'], '94.198.131.55');

    expect(
        data.validity.notBefore.toIso8601String(), '2020-11-15T09:00:18.000Z');
    expect(
        data.validity.notAfter.toIso8601String(), '2030-11-15T09:00:18.000Z');

    expect(data.subject.containsKey('2.5.4.3'), true);
    expect(data.subject['2.5.4.3'], '94.198.131.55');

    expect(data.sha1Thumbprint, 'DD7B2CE1C8DA3568E2396EA86DCC6A2B4FB9B45B');
    expect(data.md5Thumbprint, 'C588B049D87D433BE5FC6E98481A88D2');

    var publicKeyData = data.publicKeyData;

    expect(publicKeyData.length, 2048);
    expect(publicKeyData.sha1Thumbprint,
        '7884BDE6157EF1F32E2CD346A39C696F3055C10E');
    expect(publicKeyData.algorithm, '1.2.840.113549.1.1.1');
    expect(publicKeyData.bytes,
        '308201080282010100D8E1EAD54EC852F5FE0D09687A45B57FE9A873D057EA880E1BA952D447D9E23050099E730E12F184201C68809ADF48C7947B5C58D330F40905422D7D0A69E0C54F9CE27C3C7A52E7F10300E201C10CE74F94B307E63C7BAF42FDA992F1679CCDFD4D90A496F3F2D151048E14FCBF0A8B2A72D551E0DFA31238686B3ED8CCBB8B360A5F4F9B3F871BFF46BA7E27C87EAB2EC87D62732482431834D0ECA17010D9794CE83F0E6F0D065A26D83A5E1A354E19E4300F7B2A243D1D43D516A81FD96EDE71F625AA19E5D39F270AD47214941300FF6B454654C6D59CAD4737DF5911F41587316F872B1EAD85F1AF286F93CC61546B3504B64582E96B87CDDA5854E5B5020103');
  });

  test('Test x509CertificateFromPem with bigCert', () {
    var data = X509Utils.x509CertificateFromPem(bigCert);
    expect(data.version, 2);

    expect(data.serialNumber.toString(),
        '313802195999642166411276783379421068021');

    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.11');

    expect(data.issuer.containsKey('2.5.4.6'), true);
    expect(data.issuer['2.5.4.6'], 'GB');
    expect(data.issuer.containsKey('2.5.4.10'), true);
    expect(data.issuer['2.5.4.10'], 'COMODO CA Limited');
    expect(data.issuer.containsKey('2.5.4.3'), true);
    expect(data.issuer['2.5.4.3'],
        'COMODO RSA Organization Validation Secure Server CA');
  });

  test('Test pkcs7FromPem', () {
    var data = X509Utils.pkcs7fromPem(pkcs7);
    expect(data.version, 1);
    expect(data.contentType, '1.2.840.113549.1.7.2');
    expect(data.certificates!.length, 3);
  });

  test('Test csrFromPem', () {
    var data = X509Utils.csrFromPem(csr);
    expect(data.version, 0);
    expect(data.subject!.length, 6);
    expect(data.signature,
        '00C2DF2669750DB60E9D403B37096EB64EACB8C992D050E440B5C58894242ACE45CBAADF36D57567C28BFF11AA033C8072E0172FED1C40C651B0D4DDF6C4F966B892CE88A4C1A78828EA11AA116A6CA5EA9616126E099552260A9BD1C8DF0FABCF267E257862457675646657C048C14AEF8D7BE48F135DA66252BEE3307180F4C332BBDBEF7422A87AA219CFE5E548F0172ACE52CAB91AD88C73A414FAB0108E3E88C7A2AA3B3248C7255D473382738EED4F7D1DDAD24425B0C71AEB5BA8B40546BEF1C7BB873FF2C68204C537C66CDAEF9C4313D116C22141DA43635305B4701A23CAFFB6565059FDDFBB815564C6F1AD84CC039730CFF4F1C1E30A593AE83797');
    expect(data.signatureAlgorithm, '1.2.840.113549.1.1.11');
    expect(data.signatureAlgorithmReadableName, 'sha256WithRSAEncryption');
    expect(data.publicKeyInfo!.algorithm, '1.2.840.113549.1.1.1');
    expect(data.publicKeyInfo!.algorithmReadableName, 'rsaEncryption');
    expect(data.publicKeyInfo!.length, 2048);
    expect(data.publicKeyInfo!.sha1Thumbprint,
        '8DC03E4113683C6D02E0254B523C09C4A175F392');
    expect(data.publicKeyInfo!.sha256Thumbprint,
        'F187E676386764D40A901E6157310BCDF59CF0336DBC9AF077122A23D687511F');
    expect(data.publicKeyInfo!.parameter, null);
    expect(data.publicKeyInfo!.parameterReadableName, null);
  });

  test('Test csrFromPem with ECC', () {
    var data = X509Utils.csrFromPem(eccCsr);
    expect(data.version, 0);
    expect(data.subject!.length, 6);
    expect(data.signature,
        '0030440220177CF182F4BE88FB448B8DACFAB1A88D579884CC277B1452D4C704BF365752DE02206C6B76047F01BD2B0F43C60C37E69DFCB16474FBBF6605690A457FF79D0D5379');
    expect(data.signatureAlgorithm, '1.2.840.10045.4.3.2');
    expect(data.signatureAlgorithmReadableName, 'ecdsaWithSHA256');
    expect(data.publicKeyInfo!.algorithm, '1.2.840.10045.2.1');
    expect(data.publicKeyInfo!.algorithmReadableName, 'ecPublicKey');
    expect(data.publicKeyInfo!.length, 528);
    expect(data.publicKeyInfo!.sha1Thumbprint,
        'EEE9267F9374C82BCA1173623468503C5AE3A24E');
    expect(data.publicKeyInfo!.sha256Thumbprint,
        'CBAC34F18B6EE4970B45C4028FF5F2EEBF0E62AC79C8FD131DE305C49F9728FF');
    expect(data.publicKeyInfo!.parameter, '1.2.840.10045.3.1.7');
    expect(data.publicKeyInfo!.parameterReadableName, 'prime256v1');
  });

  test('Test buildOCSPRequest', () {
/*
SEQUENCE (1 elem)
  SEQUENCE (1 elem)
    SEQUENCE (1 elem)
      SEQUENCE (1 elem)
        SEQUENCE (4 elem)
          SEQUENCE (2 elem)
            OBJECT IDENTIFIER 1.3.14.3.2.26 sha1 (OIW)
            NULL
          OCTET STRING (20 byte) 9C4C7115C30219CA36DCB98B2133004CA4A78ED3
          OCTET STRING (20 byte) DDB3E76DA82EE8C54E6ECF74E6753C9415CEE81D
          INTEGER (95 bit) 34541435456031998754652058411
*/

    var data = X509Utils.buildOCSPRequest(oscpEnd, ocspInter);
    var base = base64.encode(data.encode());
    expect(base,
        'ME0wSzBJMEcwRTAJBgUrDgMCGgUABBScTHEVwwIZyjbcuYshMwBMpKeO0wQU3bPnbagu6MVObs905nU8lBXO6B0CDG+cAXgcIYAyJUpzKw==');
  });

  test('Test getOCSPUrl', () {
    var data = X509Utils.getOCSPUrl(oscpEnd);
    expect(data, 'http://ocsp2.globalsign.com/gsextendvalsha2g3r3');
  });
  test('Test parseOCSPResponse', () {
    var bytes = base64.decode(ocspResponse2);
    var data = X509Utils.parseOCSPResponse(bytes);
    expect(data.responseStatus, OCSPResponseStatus.SUCCESSFUL);
    var responseData = data.basicOCSPResponse!.responseData;
    expect(responseData!.singleResponse.length, 1);
    var certStatus = responseData.singleResponse.elementAt(0).certStatus;
    expect(certStatus.status, OCSPCertStatusValues.REVOKED);

    bytes = base64.decode(ocspResponse3);
    data = X509Utils.parseOCSPResponse(bytes);
    expect(data.responseStatus, OCSPResponseStatus.UNAUTHORIZED);
  });
}
